<!DOCTYPE html>
<html lang="ko">
<head>
Â  Â  <meta charset="UTF-8">
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  Â  <title>ì‹¤ì‹œê°„ í™˜ìœ¨ & ê¹€í”„ ëŒ€ì‹œë³´ë“œ (í™•ì¥)</title>
Â  Â  <style>
Â  Â  Â  Â  * {
Â  Â  Â  Â  Â  Â  margin: 0;
Â  Â  Â  Â  Â  Â  padding: 0;
Â  Â  Â  Â  Â  Â  box-sizing: border-box;
Â  Â  Â  Â  }

Â  Â  Â  Â  body {
Â  Â  Â  Â  Â  Â  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
Â  Â  Â  Â  Â  Â  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
Â  Â  Â  Â  Â  Â  min-height: 100vh;
Â  Â  Â  Â  Â  Â  padding: 20px;
Â  Â  Â  Â  }

Â  Â  Â  Â  .container {
Â  Â  Â  Â  Â  Â  max-width: 600px;
Â  Â  Â  Â  Â  Â  margin: 0 auto;
Â  Â  Â  Â  }

Â  Â  Â  Â  .header {
Â  Â  Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  margin-bottom: 30px;
Â  Â  Â  Â  }

Â  Â  Â  Â  .header h1 {
Â  Â  Â  Â  Â  Â  font-size: 24px;
Â  Â  Â  Â  Â  Â  margin-bottom: 10px;
Â  Â  Â  Â  }

Â  Â  Â  Â  .update-time {
Â  Â  Â  Â  Â  Â  font-size: 14px;
Â  Â  Â  Â  Â  Â  opacity: 0.9;
Â  Â  Â  Â  }

Â  Â  Â  Â  .card {
Â  Â  Â  Â  Â  Â  background: white;
Â  Â  Â  Â  Â  Â  border-radius: 16px;
Â  Â  Â  Â  Â  Â  padding: 20px;
Â  Â  Â  Â  Â  Â  margin-bottom: 16px;
Â  Â  Â  Â  Â  Â  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
Â  Â  Â  Â  }

Â  Â  Â  Â  .card-title {
Â  Â  Â  Â  Â  Â  font-size: 14px;
Â  Â  Â  Â  Â  Â  color: #666;
Â  Â  Â  Â  Â  Â  margin-bottom: 8px;
Â  Â  Â  Â  Â  Â  font-weight: 600;
Â  Â  Â  Â  }

Â  Â  Â  Â  .card-value {
Â  Â  Â  Â  Â  Â  font-size: 28px;
Â  Â  Â  Â  Â  Â  font-weight: bold;
Â  Â  Â  Â  Â  Â  color: #333;
Â  Â  Â  Â  Â  Â  margin-bottom: 4px;
Â  Â  Â  Â  }

Â  Â  Â  Â  .card-sub {
Â  Â  Â  Â  Â  Â  font-size: 14px;
Â  Â  Â  Â  Â  Â  color: #999;
Â  Â  Â  Â  }
        
        .section-title {
            color: white;
            font-size: 18px;
            font-weight: bold;
            text-align: center;
            margin: 24px 0 16px 0;
        }

Â  Â  Â  Â  .grid {
Â  Â  Â  Â  Â  Â  display: grid;
Â  Â  Â  Â  Â  Â  grid-template-columns: 1fr 1fr;
Â  Â  Â  Â  Â  Â  gap: 16px;
Â  Â  Â  Â  Â  Â  margin-bottom: 16px;
Â  Â  Â  Â  }

Â  Â  Â  Â  @media (max-width: 600px) {
Â  Â  Â  Â  Â  Â  .grid {
Â  Â  Â  Â  Â  Â  Â  Â  grid-template-columns: 1fr;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  .small-card {
Â  Â  Â  Â  Â  Â  background: white;
Â  Â  Â  Â  Â  Â  border-radius: 16px;
Â  Â  Â  Â  Â  Â  padding: 16px;
Â  Â  Â  Â  Â  Â  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
Â  Â  Â  Â  Â  Â  text-align: center; /* ì¶”ê°€ */
Â  Â  Â  Â  }
        
        .small-card-flex {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }
        
Â  Â  Â  Â  .small-card-title {
Â  Â  Â  Â  Â  Â  font-size: 12px;
Â  Â  Â  Â  Â  Â  color: #666;
Â  Â  Â  Â  Â  Â  font-weight: 600;
Â  Â  Â  Â  }

Â  Â  Â  Â  .small-card-value {
Â  Â  Â  Â  Â  Â  font-size: 20px;
Â  Â  Â  Â  Â  Â  font-weight: bold;
Â  Â  Â  Â  Â  Â  color: #333;
Â  Â  Â  Â  }

Â  Â  Â  Â  .premium {
Â  Â  Â  Â  Â  Â  font-size: 14px;
Â  Â  Â  Â  Â  Â  margin-top: 4px;
Â  Â  Â  Â  Â  Â  font-weight: 600;
Â  Â  Â  Â  }

Â  Â  Â  Â  .premium.positive {
Â  Â  Â  Â  Â  Â  color: #e74c3c;
Â  Â  Â  Â  }

Â  Â  Â  Â  .premium.negative {
Â  Â  Â  Â  Â  Â  color: #3498db;
Â  Â  Â  Â  }

Â  Â  Â  Â  .loading {
Â  Â  Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  padding: 20px;
Â  Â  Â  Â  }

Â  Â  Â  Â  .refresh-btn {
Â  Â  Â  Â  Â  Â  background: white;
Â  Â  Â  Â  Â  Â  border: none;
Â  Â  Â  Â  Â  Â  border-radius: 12px;
Â  Â  Â  Â  Â  Â  padding: 12px 24px;
Â  Â  Â  Â  Â  Â  font-size: 14px;
Â  Â  Â  Â  Â  Â  font-weight: 600;
Â  Â  Â  Â  Â  Â  color: #667eea;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  margin-top: 16px;
Â  Â  Â  Â  Â  Â  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
Â  Â  Â  Â  }

Â  Â  Â  Â  .refresh-btn:active {
Â  Â  Â  Â  Â  Â  transform: scale(0.98);
Â  Â  Â  Â  }

Â  Â  Â  Â  .info-card {
Â  Â  Â  Â  Â  Â  background: rgba(255, 255, 255, 0.95);
Â  Â  Â  Â  Â  Â  border-radius: 12px;
Â  Â  Â  Â  Â  Â  padding: 16px;
Â  Â  Â  Â  Â  Â  margin-bottom: 16px;
Â  Â  Â  Â  Â  Â  font-size: 13px;
Â  Â  Â  Â  Â  Â  line-height: 1.6;
Â  Â  Â  Â  Â  Â  color: #555;
Â  Â  Â  Â  }

Â  Â  Â  Â  .info-card strong {
Â  Â  Â  Â  Â  Â  color: #333;
Â  Â  Â  Â  }

Â  Â  Â  Â  .source-tag {
Â  Â  Â  Â  Â  Â  display: inline-block;
Â  Â  Â  Â  Â  Â  background: #667eea;
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  padding: 2px 8px;
Â  Â  Â  Â  Â  Â  border-radius: 4px;
Â  Â  Â  Â  Â  Â  font-size: 11px;
Â  Â  Â  Â  Â  Â  margin-top: 4px;
Â  Â  Â  Â  }
        
        .kimp-info {
            font-size: 14px;
            color: #555;
            text-align: left;
        }

Â  Â  Â  Â  @media (max-width: 480px) {
Â  Â  Â  Â  Â  Â  .card-value {
Â  Â  Â  Â  Â  Â  Â  Â  font-size: 24px;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  .small-card-value {
Â  Â  Â  Â  Â  Â  Â  Â  font-size: 18px;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  </style>
</head>
<body>
Â  Â  <div class="container">
Â  Â  Â  Â  <div class="header">
Â  Â  Â  Â  Â  Â  <h1>ğŸ’± ì‹¤ì‹œê°„ í™˜ìœ¨ & ê¹€í”„</h1>
Â  Â  Â  Â  Â  Â  <div class="update-time" id="updateTime">ë¡œë”© ì¤‘...</div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div id="content" class="loading">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
Â  Â  </div>

Â  Â  <script>
Â  Â  Â  Â  // ìºì‹œ ì‹œìŠ¤í…œ
Â  Â  Â  Â  const cache = {
Â  Â  Â  Â  Â  Â  data: null,
Â  Â  Â  Â  Â  Â  timestamp: 0,
Â  Â  Â  Â  Â  Â  TTL: 30000 // 30ì´ˆ ìºì‹œ
Â  Â  Â  Â  };

Â  Â  Â  Â  let isLoading = false;
Â  Â  Â  Â  let retryCount = 0;
Â  Â  Â  Â  const MAX_RETRIES = 3;

Â  Â  Â  Â  // ëŒ€ê¸° í•¨ìˆ˜
Â  Â  Â  Â  function sleep(ms) {
Â  Â  Â  Â  Â  Â  return new Promise(resolve => setTimeout(resolve, ms));
Â  Â  Â  Â  }

Â  Â  Â  Â  // íƒ€ì„ì•„ì›ƒ ë° ì¬ì‹œë„ ë¡œì§
Â  Â  Â  Â  async function fetchWithTimeout(url, timeout = 8000, retries = 2) {
Â  Â  Â  Â  Â  Â  for (let i = 0; i <= retries; i++) {
Â  Â  Â  Â  Â  Â  Â  Â  const controller = new AbortController();
Â  Â  Â  Â  Â  Â  Â  Â  const id = setTimeout(() => controller.abort(), timeout);
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const response = await fetch(url, { signal: controller.signal });
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  clearTimeout(id);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (response.status === 429) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const waitTime = Math.pow(2, i) * 2000;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  console.warn(`API ìš”ì²­ ì œí•œ. ${waitTime/1000}ì´ˆ í›„ ì¬ì‹œë„... (${i+1}/${retries+1})`);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (i < retries) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  await sleep(waitTime);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  continue;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  throw new Error('API ìš”ì²­ ì œí•œ ì´ˆê³¼');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (!response.ok) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  throw new Error(`HTTP ${response.status}`);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return response;
Â  Â  Â  Â  Â  Â  Â  Â  } catch (error) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  clearTimeout(id);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (i < retries && !error.message.includes('aborted')) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const waitTime = Math.pow(2, i) * 1000;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  console.log(`ì¬ì‹œë„ ëŒ€ê¸° ì¤‘... (${i+1}/${retries+1})`);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  await sleep(waitTime);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  continue;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  throw error;
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  // í™˜ìœ¨ ê°€ì ¸ì˜¤ê¸° (ì—¬ëŸ¬ API ì‹œë„)
Â  Â  Â  Â  async function getExchangeRate() {
Â  Â  Â  Â  Â  Â  const apis = [
Â  Â  Â  Â  Â  Â  Â  Â  { url: 'https://open.er-api.com/v6/latest/USD', parse: (data) => data.rates.KRW },
Â  Â  Â  Â  Â  Â  Â  Â  { url: 'https://api.exchangerate-api.com/v4/latest/USD', parse: (data) => data.rates.KRW },
Â  Â  Â  Â  Â  Â  Â  Â  { url: 'https://cdn.jsdelivr.net/npm/@fawazahmed0/currency-api@latest/v1/currencies/usd.json', parse: (data) => data.usd.krw }
Â  Â  Â  Â  Â  Â  ];

Â  Â  Â  Â  Â  Â  for (const api of apis) {
Â  Â  Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const res = await fetchWithTimeout(api.url, 3000);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const rate = api.parse(await res.json());
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (rate && rate > 0) return rate;
Â  Â  Â  Â  Â  Â  Â  Â  } catch (e) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  console.log(`í™˜ìœ¨ API ì‹¤íŒ¨: ${api.url}`, e.message);
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  return 1300; // ê¸°ë³¸ê°’
Â  Â  Â  Â  }
        
        // ë°”ì´ë‚¸ìŠ¤ USDT, USDC ê°€ê²© ê°€ì ¸ì˜¤ê¸° (1ë‹¬ëŸ¬ë‹¹ ê°€ê²©)
        async function getBinanceStablePrice() {
            try {
                // USDT/USD ë° USDC/USD ê°€ê²©ì„ ì–»ê¸° ìœ„í•´ USDT/BUSDì™€ USDC/BUSDë¥¼ ì‚¬ìš© (BUSDëŠ” ë‹¬ëŸ¬ì™€ 1:1)
                const binanceRes = await fetchWithTimeout(
                    'https://api.binance.com/api/v3/ticker/price?symbols=["USDTBUSD","USDCBUSD"]',
                    5000, 1
                );
                const data = await binanceRes.json();
                
                const usdtPrice = parseFloat(data.find(item => item.symbol === 'USDTBUSD')?.price || 1.0);
                const usdcPrice = parseFloat(data.find(item => item.symbol === 'USDCBUSD')?.price || 1.0);
                
                return { usdt: usdtPrice, usdc: usdcPrice };
            } catch (e) {
                console.error("ë°”ì´ë‚¸ìŠ¤ ìŠ¤í…Œì´ë¸”ì½”ì¸ ê°€ê²© ì¡°íšŒ ì‹¤íŒ¨", e);
                return { usdt: 1.0, usdc: 1.0 }; // ì˜¤ë¥˜ ì‹œ 1ë‹¬ëŸ¬ë¡œ ê°„ì£¼
            }
        }

        // ì—…ë¹„íŠ¸ BTC/ETH ë° ìŠ¤í…Œì´ë¸” ì½”ì¸ ê°€ê²© ê°€ì ¸ì˜¤ê¸°
        async function getUpbitPrices() {
            try {
                const markets = 'KRW-USDT,KRW-USDC,KRW-BTC,KRW-ETH';
                const upbitRes = await fetchWithTimeout(
                    `https://api.upbit.com/v1/ticker?markets=${markets}`,
                    10000, 2
                );
                const data = await upbitRes.json();
                
                const upbitData = {
                    usdt: data.find(item => item.market === 'KRW-USDT')?.trade_price || 0,
                    usdc: data.find(item => item.market === 'KRW-USDC')?.trade_price || 0,
                    btc: data.find(item => item.market === 'KRW-BTC')?.trade_price || 0,
                    eth: data.find(item => item.market === 'KRW-ETH')?.trade_price || 0,
                };
                
                if (!upbitData.btc || !upbitData.eth) {
                    throw new Error('ì—…ë¹„íŠ¸ BTC/ETH ë°ì´í„° ëˆ„ë½');
                }
                
                return upbitData;

            } catch (e) {
                console.error("ì—…ë¹„íŠ¸ ê°€ê²© ì¡°íšŒ ì‹¤íŒ¨", e);
                return { usdt: 0, usdc: 0, btc: 0, eth: 0 };
            }
        }
        
        // ë°”ì´ë‚¸ìŠ¤ BTC/ETH ê°€ê²© ê°€ì ¸ì˜¤ê¸° (USDT ë§ˆì¼“ ê¸°ì¤€)
        async function getBinanceCoinPrices() {
            try {
                const binanceRes = await fetchWithTimeout(
                    'https://api.binance.com/api/v3/ticker/price?symbols=["BTCUSDT","ETHUSDT"]',
                    5000, 1
                );
                const data = await binanceRes.json();
                
                const binanceData = {
                    btc: parseFloat(data.find(item => item.symbol === 'BTCUSDT')?.price || 0),
                    eth: parseFloat(data.find(item => item.symbol === 'ETHUSDT')?.price || 0),
                };
                
                if (!binanceData.btc || !binanceData.eth) {
                    throw new Error('ë°”ì´ë‚¸ìŠ¤ BTC/ETH ë°ì´í„° ëˆ„ë½');
                }
                
                return binanceData;
            } catch (e) {
                console.error("ë°”ì´ë‚¸ìŠ¤ BTC/ETH ê°€ê²© ì¡°íšŒ ì‹¤íŒ¨", e);
                return { btc: 0, eth: 0 };
            }
        }


Â  Â  Â  Â  async function fetchData() {
Â  Â  Â  Â  Â  Â  if (isLoading) { return; }
Â  Â  Â  Â  Â  Â  const now = Date.now();
Â  Â  Â  Â  Â  Â  if (cache.data && (now - cache.timestamp) < cache.TTL) {
Â  Â  Â  Â  Â  Â  Â  Â  displayData(cache.data);
Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  isLoading = true;
Â  Â  Â  Â  Â  Â  const startTime = Date.now();
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  console.log('=== ë°ì´í„° ë¡œë”© ì‹œì‘ (í™•ì¥) ===');
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  // ëª¨ë“  ë°ì´í„° ë™ì‹œ ìš”ì²­
Â  Â  Â  Â  Â  Â  Â  Â  const [usdKrw, upbitData, binanceCoinData, binanceStable] = await Promise.all([
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  getExchangeRate(),
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  getUpbitPrices(),
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  getBinanceCoinPrices(),
                    getBinanceStablePrice()
Â  Â  Â  Â  Â  Â  Â  Â  ]);

Â  Â  Â  Â  Â  Â  Â  Â  if (!upbitData.btc || !binanceCoinData.btc || usdKrw < 100) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  throw new Error('í•µì‹¬ ë°ì´í„°(í™˜ìœ¨, BTC)ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  // USDT/USDC ì›í™” í™˜ì‚° ê°€ê²© ê¸°ë°˜ ê¹€í”„ (ì´ì „ ë¡œì§)
Â  Â  Â  Â  Â  Â  Â  Â  const usdtPremium = ((upbitData.usdt / usdKrw - 1) * 100).toFixed(2);
Â  Â  Â  Â  Â  Â  Â  Â  const usdcPremium = ((upbitData.usdc / usdKrw - 1) * 100).toFixed(2);
                
                // ë°”ì´ë‚¸ìŠ¤ ìŠ¤í…Œì´ë¸”ì½”ì¸ 1ë‹¬ëŸ¬ ëŒ€ë¹„ ì°¨ì´ (%)
                const binanceUsdtDiff = ((binanceStable.usdt - 1) * 100).toFixed(4); // 0.9998 -> -0.02%
                const binanceUsdcDiff = ((binanceStable.usdc - 1) * 100).toFixed(4); // 1.0001 -> +0.01%
                
                // BTC, ETH ê¹€í”„ ê³„ì‚° (ì—…ë¹„íŠ¸ KRW vs. ë°”ì´ë‚¸ìŠ¤ USDT * í™˜ìœ¨)
                const btcKimp = ((upbitData.btc / (binanceCoinData.btc * usdKrw) - 1) * 100).toFixed(2);
                const ethKimp = ((upbitData.eth / (binanceCoinData.eth * usdKrw) - 1) * 100).toFixed(2);

Â  Â  Â  Â  Â  Â  Â  Â  const loadTime = ((Date.now() - startTime) / 1000).toFixed(2);
Â  Â  Â  Â  Â  Â  Â  Â  console.log(`=== ë°ì´í„° ë¡œë”© ì™„ë£Œ (${loadTime}ì´ˆ) ===`);

Â  Â  Â  Â  Â  Â  Â  Â  const resultData = {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  usdKrw: usdKrw.toFixed(2),
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // ì—…ë¹„íŠ¸ ìŠ¤í…Œì´ë¸”
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  upbitUsdt: upbitData.usdt.toLocaleString('ko-KR'),
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  upbitUsdc: upbitData.usdc.toLocaleString('ko-KR'),
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  usdtPremium,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  usdcPremium,
                    // ë°”ì´ë‚¸ìŠ¤ ìŠ¤í…Œì´ë¸”
                    binanceUsdt: binanceStable.usdt.toFixed(4),
                    binanceUsdc: binanceStable.usdc.toFixed(4),
                    binanceUsdtDiff,
                    binanceUsdcDiff,
                    // BTC/ETH ë°ì´í„°
                    upbitBtc: upbitData.btc.toLocaleString('ko-KR', { maximumFractionDigits: 0 }),
                    upbitEth: upbitData.eth.toLocaleString('ko-KR', { maximumFractionDigits: 0 }),
                    binanceBtc: binanceCoinData.btc.toLocaleString('en-US', { maximumFractionDigits: 2 }),
                    binanceEth: binanceCoinData.eth.toLocaleString('en-US', { maximumFractionDigits: 2 }),
                    btcKimp,
                    ethKimp,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  loadTime
Â  Â  Â  Â  Â  Â  Â  Â  };

Â  Â  Â  Â  Â  Â  Â  Â  cache.data = resultData;
Â  Â  Â  Â  Â  Â  Â  Â  cache.timestamp = Date.now();
Â  Â  Â  Â  Â  Â  Â  Â  retryCount = 0;

Â  Â  Â  Â  Â  Â  Â  Â  displayData(resultData);

Â  Â  Â  Â  Â  Â  } catch (error) {
Â  Â  Â  Â  Â  Â  Â  Â  console.error('=== ì˜¤ë¥˜ ë°œìƒ ===', error);
Â  Â  Â  Â  Â  Â  Â  Â  retryCount++;

Â  Â  Â  Â  Â  Â  Â  Â  if (cache.data && (Date.now() - cache.timestamp) < 3600000) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  displayData(cache.data, true);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  const waitMinutes = Math.min(retryCount * 2, 10);
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('content').innerHTML = `
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style="color: white; text-align: center;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p style="font-size: 18px; margin-bottom: 15px;">âš ï¸ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤</p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p style="font-size: 14px; margin-top: 10px;">ì˜¤ë¥˜: ${error.message}</p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p style="font-size: 13px; margin-top: 15px; opacity: 0.9; line-height: 1.6;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ${retryCount >= MAX_RETRIESÂ 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ? `ë„ˆë¬´ ë§ì€ ìš”ì²­ìœ¼ë¡œ API ì œí•œì´ ê±¸ë ¸ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br>ì•½ ${waitMinutes}ë¶„ í›„ì— ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.`
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  : 'ë„¤íŠ¸ì›Œí¬ê°€ ë¶ˆì•ˆì •í•˜ê±°ë‚˜ API ì„œë²„ì— ë¬¸ì œê°€ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.'
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style="background: rgba(255,255,255,0.1); border-radius: 8px; padding: 12px; margin: 15px 0; font-size: 12px;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <strong>ğŸ’¡ í•´ê²° ë°©ë²•</strong><br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  1. 1-2ë¶„ ì •ë„ ê¸°ë‹¤ë¦° í›„ ìƒˆë¡œê³ ì¹¨<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  2. ë¸Œë¼ìš°ì € íƒ­ì„ ë‹«ì•˜ë‹¤ê°€ ë‹¤ì‹œ ì—´ê¸°<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  3. ì‹œí¬ë¦¿ ëª¨ë“œë¡œ ì ‘ì†í•´ë³´ê¸°
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="refresh-btn" onclick="manualRefresh()" style="margin-top: 15px;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ğŸ”„ ë‹¤ì‹œ ì‹œë„ ${retryCount >= MAX_RETRIES ? `(${waitMinutes}ë¶„ í›„ ê¶Œì¥)` : ''}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  `;
Â  Â  Â  Â  Â  Â  } finally {
Â  Â  Â  Â  Â  Â  Â  Â  isLoading = false;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  function manualRefresh() {
Â  Â  Â  Â  Â  Â  cache.timestamp = 0;
Â  Â  Â  Â  Â  Â  fetchData();
Â  Â  Â  Â  }

Â  Â  Â  Â  // ê¹€í”„ í¼ì„¼íŠ¸ë¥¼ í‘œì‹œí•˜ëŠ” í—¬í¼ í•¨ìˆ˜
        function renderPremium(premium, showSign = true) {
            const sign = premium >= 0 ? '+' : '';
            const className = premium >= 0 ? 'positive' : 'negative';
            return `<div class="premium ${className}">${showSign ? sign : ''}${premium}%</div>`;
        }
        
        // ì½”ì¸ ì‹œì„¸ ë° ê¹€í”„ ì¹´ë“œë¥¼ ë Œë”ë§í•˜ëŠ” í—¬í¼ í•¨ìˆ˜
        function renderKimpCard(coin, upbitPrice, binancePrice, kimp) {
            return `
                <div class="card">
                    <div class="small-card-flex">
                        <div class="card-title">${coin} ì‹œì„¸ ë° ê¹€í”„</div>
                        ${renderPremium(kimp, true)}
                    </div>
                    <div class="kimp-info">
                        <strong>ì—…ë¹„íŠ¸ (KRW):</strong> â‚©${upbitPrice}<br>
                        <strong>ë°”ì´ë‚¸ìŠ¤ (USDT):</strong> $${binancePrice}
                    </div>
                    <div style="margin-top: 8px;">
                        <span class="source-tag">ì—…ë¹„íŠ¸ / ë°”ì´ë‚¸ìŠ¤</span>
                    </div>
                </div>
            `;
        }


Â  Â  Â  Â  function displayData(data, isFromCache = false) {
Â  Â  Â  Â  Â  Â  const now = new Date();
Â  Â  Â  Â  Â  Â  const timeString = now.toLocaleString('ko-KR', {
Â  Â  Â  Â  Â  Â  Â  Â  month: 'long', day: 'numeric', hour: '2-digit', minute: '2-digit'
Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  const cacheWarning = isFromCache ? ' <span style="color: #f39c12;">(ìºì‹œ)</span>' : '';
Â  Â  Â  Â  Â  Â  document.getElementById('updateTime').innerHTML = `ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸: ${timeString} (${data.loadTime}ì´ˆ)${cacheWarning}`;

Â  Â  Â  Â  Â  Â  const content = `
                Â  Â  Â  Â  Â  Â  Â  Â  <div class="card">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="card-title">USD/KRW í™˜ìœ¨</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="card-value">â‚©${data.usdKrw}</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="card-sub">1ë‹¬ëŸ¬ë‹¹</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="source-tag">ExchangeRate-API</div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
                
                <div class="section-title">ğŸŒ í•´ì™¸ ìŠ¤í…Œì´ë¸”ì½”ì¸ ì‹œì„¸ (1 USD ê¸°ì¤€)</div>
                <div class="grid">
                    <div class="small-card">
                        <div class="small-card-title">ë°”ì´ë‚¸ìŠ¤ USDT (í…Œë”)</div>
                        <div class="small-card-value">$${data.binanceUsdt}</div>
                        ${renderPremium(data.binanceUsdtDiff, true)}
                        <div class="source-tag">ë°”ì´ë‚¸ìŠ¤</div>
                    </div>

                    <div class="small-card">
                        <div class="small-card-title">ë°”ì´ë‚¸ìŠ¤ USDC</div>
                        <div class="small-card-value">$${data.binanceUsdc}</div>
                        ${renderPremium(data.binanceUsdcDiff, true)}
                        <div class="source-tag">ë°”ì´ë‚¸ìŠ¤</div>
                    </div>
                </div>

Â  Â  Â  Â  Â  Â  Â  Â  <div class="section-title">ğŸ‡°ğŸ‡· ì—…ë¹„íŠ¸ USDT/USDC ê¹€í”„ (í™˜ìœ¨ ëŒ€ë¹„)</div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="grid">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="small-card">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="small-card-title">USDT (í…Œë”)</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="small-card-value">â‚©${data.upbitUsdt}</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ${renderPremium(data.usdtPremium, true)}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="source-tag">ì—…ë¹„íŠ¸</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="small-card">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="small-card-title">USDC</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="small-card-value">â‚©${data.upbitUsdc}</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ${renderPremium(data.usdcPremium, true)}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="source-tag">ì—…ë¹„íŠ¸</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
                
                <div class="section-title">ğŸ“ˆ ì£¼ìš” ì½”ì¸ë³„ ê¹€í”„ í˜„í™© (ì—…ë¹„íŠ¸ vs ë°”ì´ë‚¸ìŠ¤)</div>
                ${renderKimpCard('ë¹„íŠ¸ì½”ì¸ (BTC)', data.upbitBtc, data.binanceBtc, data.btcKimp)}
                ${renderKimpCard('ì´ë”ë¦¬ì›€ (ETH)', data.upbitEth, data.binanceEth, data.ethKimp)}


Â  Â  Â  Â  Â  Â  Â  Â  <div class="info-card">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <strong>ğŸ“Š ê¹€í”„ ê³„ì‚° ë°©ì‹</strong><br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <strong>1. ìŠ¤í…Œì´ë¸”ì½”ì¸ (USDT/USDC):</strong><br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  &nbsp;&nbsp;&nbsp;ê¹€í”„(%) = (ì—…ë¹„íŠ¸ ê°€ê²© / í™˜ìœ¨ - 1) Ã— 100<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <strong>2. ì½”ì¸ (BTC/ETH):</strong><br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  &nbsp;&nbsp;&nbsp;ê¹€í”„(%) = (ì—…ë¹„íŠ¸ KRW ê°€ê²© / (ë°”ì´ë‚¸ìŠ¤ USDT ê°€ê²© Ã— í™˜ìœ¨) - 1) Ã— 100<br><br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <strong style="color: #e74c3c;">í”ŒëŸ¬ìŠ¤(+)</strong>: í•œêµ­ì´ ë” ë¹„ìŒˆ (ê¹€ì¹˜ í”„ë¦¬ë¯¸ì—„)<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <strong style="color: #3498db;">ë§ˆì´ë„ˆìŠ¤(-)</strong>: í•œêµ­ì´ ë” ìŒˆ (ì—­í”„/ë””ìŠ¤ì¹´ìš´íŠ¸)<br><br>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ë°”ì´ë‚¸ìŠ¤ ìŠ¤í…Œì´ë¸”ì½”ì¸ì€ **1 USDì— ê°€ê¹ê²Œ ê±°ë˜ë˜ëŠ” ì •ë„**ë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤.
                    (ì˜ˆ: $1.0005ëŠ” 1ë‹¬ëŸ¬ë³´ë‹¤ 0.05% ë¹„ìŒˆ)<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style="border-top: 1px solid #eee; margin-top: 12px; padding-top: 12px; font-size: 12px;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  âš ï¸ <strong>ì•ˆë‚´ì‚¬í•­</strong><br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â€¢ API í˜¸ì¶œ ì œí•œì„ ìœ„í•´ 90ì´ˆë§ˆë‹¤ ì—…ë°ì´íŠ¸ë©ë‹ˆë‹¤.<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â€¢ ìƒˆë¡œê³ ì¹¨ ë²„íŠ¼ì„ ì—°ì†ìœ¼ë¡œ ëˆ„ë¥´ë©´ API ì œí•œì´ ê±¸ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â€¢ ì •í™•í•œ ë°ì´í„°ëŠ” <a href="https://kimpga.com/" target="_blank" style="color: #667eea; font-weight: bold; text-decoration: none;">ì „ë¬¸ ê¹€í”„ ì‚¬ì´íŠ¸</a>ì—ì„œ ì§ì ‘ í™•ì¸í•˜ì‹œëŠ” ê²ƒì„ ê¶Œì¥í•©ë‹ˆë‹¤.
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  <button class="refresh-btn" onclick="manualRefresh()">ğŸ”„ ìƒˆë¡œê³ ì¹¨</button>
Â  Â  Â  Â  Â  Â  `;

Â  Â  Â  Â  Â  Â  document.getElementById('content').innerHTML = content;
Â  Â  Â  Â  }

Â  Â  Â  Â  // ì´ˆê¸° ë¡œë“œ ë° ìë™ ì—…ë°ì´íŠ¸
Â  Â  Â  Â  fetchData();
Â  Â  Â  Â  setInterval(fetchData, 90000); // 90ì´ˆë§ˆë‹¤ ì—…ë°ì´íŠ¸
Â  Â  </script>
</body>
</html>
