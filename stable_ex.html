

<!DOCTYPE html>

<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê°œì„ ëœ í™˜ìœ¨ ë°ì´í„°</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            max-width: 800px;
            margin: 40px auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        .card {
            background: white;
            border-radius: 16px;
            padding: 24px;
            margin: 16px 0;
            color: #333;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        .rate-source {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            margin: 8px 0;
            background: #f5f5f5;
            border-radius: 8px;
        }
        .rate-value {
            font-size: 24px;
            font-weight: bold;
            color: #667eea;
        }
        .status {
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }
        .status.success { background: #d4edda; color: #155724; }
        .status.error { background: #f8d7da; color: #721c24; }
        .recommended {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 16px;
            border-radius: 8px;
            margin-top: 16px;
            font-weight: bold;
        }
        button {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin: 8px 4px;
        }
        button:hover { background: #5568d3; }
        .info {
            background: rgba(255,255,255,0.1);
            padding: 12px;
            border-radius: 8px;
            margin: 16px 0;
            font-size: 14px;
        }
        .comparison {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px;
            margin-top: 16px;
        }
        .comparison-item {
            background: #f8f9fa;
            padding: 12px;
            border-radius: 8px;
            text-align: center;
        }
        .comparison-item strong {
            display: block;
            font-size: 18px;
            color: #667eea;
            margin-top: 4px;
        }
    </style>
</head>
<body>
    <h1>ğŸ’± í™˜ìœ¨ ë°ì´í„° ë¹„êµ (ì£¼ë§ í¬í•¨)</h1>


<div class="info">
    â° <strong>ì£¼ë§ì—ë„ ì‘ë™í•˜ëŠ” ë°©ë²•ë“¤</strong><br>
    â€¢ ì •ì  í™˜ìœ¨ API: ë§ˆì§€ë§‰ ê±°ë˜ì¼ ë°ì´í„° ì‚¬ìš©<br>
    â€¢ ì‹¤ì‹œê°„ ë°©ë²•: ì—…ë¹„íŠ¸-ë°”ì´ë‚¸ìŠ¤ USDT ì—­ì‚° (24/7 ì‹¤ì‹œê°„!)
</div>

<button onclick="testAllSources()">ğŸ”„ ëª¨ë“  ì†ŒìŠ¤ í…ŒìŠ¤íŠ¸</button>
<button onclick="testRealtime()">âš¡ ì‹¤ì‹œê°„ ë°©ë²• í…ŒìŠ¤íŠ¸</button>

<div id="results"></div>
<div id="comparison"></div>

<script>
    // 1. exchangerate.host (ì¶”ì²œ)
    async function getExchangeRateHost() {
        const response = await fetch('https://api.exchangerate.host/latest?base=USD&symbols=KRW');
        const data = await response.json();
        return {
            rate: data.rates.KRW,
            date: data.date,
            source: 'exchangerate.host'
        };
    }

    // 2. frankfurter.app (ECB ê¸°ë°˜)
    async function getFrankfurter() {
        const response = await fetch('https://api.frankfurter.app/latest?from=USD&to=KRW');
        const data = await response.json();
        return {
            rate: data.rates.KRW,
            date: data.date,
            source: 'frankfurter.app'
        };
    }

    // 3. open.er-api.com (í˜„ì¬ ì‚¬ìš©ì¤‘)
    async function getOpenER() {
        const response = await fetch('https://open.er-api.com/v6/latest/USD');
        const data = await response.json();
        return {
            rate: data.rates.KRW,
            date: new Date(data.time_last_update_unix * 1000).toISOString().split('T')[0],
            source: 'open.er-api.com'
        };
    }

    // 4. ì‹¤ì‹œê°„ ë°©ë²•: ì—…ë¹„íŠ¸-ë°”ì´ë‚¸ìŠ¤ USDT ì—­ì‚°
    async function getRealTimeRate() {
        // ì—…ë¹„íŠ¸ USDT/KRW
        const upbitRes = await fetch('https://api.upbit.com/v1/ticker?markets=KRW-USDT');
        const [upbitData] = await upbitRes.json();
        const upbitUsdtKrw = upbitData.trade_price;

        // ë°”ì´ë‚¸ìŠ¤ USDT/USD
        const binanceRes = await fetch('https://api.binance.com/api/v3/ticker/price?symbol=USDTUSD');
        const binanceData = await binanceRes.json();
        const binanceUsdtUsd = parseFloat(binanceData.price);

        // ì‹¤ì‹œê°„ í™˜ìœ¨ ê³„ì‚°
        const realTimeRate = upbitUsdtKrw / binanceUsdtUsd;

        return {
            rate: realTimeRate,
            date: new Date().toISOString().split('T')[0],
            source: 'ì‹¤ì‹œê°„ (USDT ì—­ì‚°)',
            details: {
                upbitUsdt: upbitUsdtKrw,
                binanceUsdt: binanceUsdtUsd
            }
        };
    }

    // ëª¨ë“  ì†ŒìŠ¤ í…ŒìŠ¤íŠ¸
    async function testAllSources() {
        const resultsDiv = document.getElementById('results');
        const comparisonDiv = document.getElementById('comparison');
        resultsDiv.innerHTML = '<div class="card"><h2>ë°ì´í„° ìˆ˜ì§‘ ì¤‘...</h2></div>';
        comparisonDiv.innerHTML = '';

        const sources = [
            { name: 'exchangerate.host', fn: getExchangeRateHost },
            { name: 'frankfurter.app', fn: getFrankfurter },
            { name: 'open.er-api.com', fn: getOpenER },
            { name: 'ì‹¤ì‹œê°„ (USDT)', fn: getRealTimeRate }
        ];

        const results = [];
        let html = '<div class="card"><h2>ğŸ“Š í™˜ìœ¨ ë°ì´í„° ë¹„êµ</h2>';

        for (const source of sources) {
            try {
                const start = Date.now();
                const result = await source.fn();
                const loadTime = Date.now() - start;
                
                results.push(result);
                
                html += `
                    <div class="rate-source">
                        <div>
                            <strong>${result.source}</strong><br>
                            <small>ì—…ë°ì´íŠ¸: ${result.date} (${loadTime}ms)</small>
                            ${result.details ? `<br><small>ì—…ë¹„íŠ¸ USDT: â‚©${result.details.upbitUsdt.toLocaleString()}</small>` : ''}
                        </div>
                        <div>
                            <div class="rate-value">â‚©${result.rate.toFixed(2)}</div>
                            <span class="status success">âœ“ ì„±ê³µ</span>
                        </div>
                    </div>
                `;
            } catch (error) {
                html += `
                    <div class="rate-source">
                        <div><strong>${source.name}</strong></div>
                        <div>
                            <span class="status error">âœ— ì‹¤íŒ¨</span><br>
                            <small>${error.message}</small>
                        </div>
                    </div>
                `;
            }
        }

        // í†µê³„ ê³„ì‚°
        if (results.length > 0) {
            const rates = results.map(r => r.rate);
            const avg = rates.reduce((a, b) => a + b, 0) / rates.length;
            const max = Math.max(...rates);
            const min = Math.min(...rates);
            const spread = max - min;

            html += `
                <div class="recommended">
                    ğŸ’¡ ê¶Œì¥ í™˜ìœ¨: â‚©${avg.toFixed(2)} (${results.length}ê°œ ì†ŒìŠ¤ í‰ê· )
                </div>
            `;

            comparisonDiv.innerHTML = `
                <div class="card">
                    <h3>ğŸ“ˆ í†µê³„ ë¶„ì„</h3>
                    <div class="comparison">
                        <div class="comparison-item">
                            <div>í‰ê·  í™˜ìœ¨</div>
                            <strong>â‚©${avg.toFixed(2)}</strong>
                        </div>
                        <div class="comparison-item">
                            <div>ìµœê³ ê°€</div>
                            <strong>â‚©${max.toFixed(2)}</strong>
                        </div>
                        <div class="comparison-item">
                            <div>ìµœì €ê°€</div>
                            <strong>â‚©${min.toFixed(2)}</strong>
                        </div>
                        <div class="comparison-item">
                            <div>ìŠ¤í”„ë ˆë“œ</div>
                            <strong>â‚©${spread.toFixed(2)}</strong>
                            <small>(${((spread/avg)*100).toFixed(2)}%)</small>
                        </div>
                    </div>
                    <div class="info" style="margin-top: 16px; background: #fff3cd; color: #856404;">
                        âš ï¸ <strong>ìŠ¤í”„ë ˆë“œê°€ ${spread.toFixed(2)}ì› (${((spread/avg)*100).toFixed(2)}%)</strong><br>
                        ${spread > 10 ? 'ì°¨ì´ê°€ í½ë‹ˆë‹¤. ì‹¤ì‹œê°„ ë°©ë²•ì„ ì¶”ì²œí•©ë‹ˆë‹¤.' : 'ì°¨ì´ê°€ ì‘ìŠµë‹ˆë‹¤. ëª¨ë“  ì†ŒìŠ¤ê°€ ì‹ ë¢°í•  ë§Œí•©ë‹ˆë‹¤.'}
                    </div>
                </div>
            `;
        }

        html += '</div>';
        resultsDiv.innerHTML = html;
    }

    // ì‹¤ì‹œê°„ ë°©ë²•ë§Œ í…ŒìŠ¤íŠ¸
    async function testRealtime() {
        const resultsDiv = document.getElementById('results');
        resultsDiv.innerHTML = '<div class="card"><h2>âš¡ ì‹¤ì‹œê°„ ë°ì´í„° ìˆ˜ì§‘ ì¤‘...</h2></div>';

        try {
            const result = await getRealTimeRate();
            
            resultsDiv.innerHTML = `
                <div class="card">
                    <h2>âš¡ ì‹¤ì‹œê°„ í™˜ìœ¨ (USDT ì—­ì‚°)</h2>
                    <div class="rate-source">
                        <div>
                            <strong>USD/KRW ì‹¤ì‹œê°„</strong><br>
                            <small>ê³„ì‚° ì‹œê°: ${new Date().toLocaleString('ko-KR')}</small>
                        </div>
                        <div class="rate-value">â‚©${result.rate.toFixed(2)}</div>
                    </div>
                    
                    <h3 style="margin-top: 24px;">ğŸ” ê³„ì‚° ê³¼ì •</h3>
                    <div class="info" style="background: #e3f2fd; color: #0d47a1;">
                        <strong>1ë‹¨ê³„:</strong> ì—…ë¹„íŠ¸ USDT ê°€ê²©<br>
                        â†’ â‚©${result.details.upbitUsdt.toLocaleString()} KRW<br><br>
                        
                        <strong>2ë‹¨ê³„:</strong> ë°”ì´ë‚¸ìŠ¤ USDT ê°€ê²©<br>
                        â†’ $${result.details.binanceUsdt} USD<br><br>
                        
                        <strong>3ë‹¨ê³„:</strong> í™˜ìœ¨ ê³„ì‚°<br>
                        â†’ ${result.details.upbitUsdt.toLocaleString()} Ã· ${result.details.binanceUsdt}<br>
                        â†’ <strong>â‚©${result.rate.toFixed(2)}</strong>
                    </div>

                    <div class="info" style="background: #d4edda; color: #155724; margin-top: 16px;">
                        âœ… <strong>ì¥ì </strong><br>
                        â€¢ 24/7 ì‹¤ì‹œê°„ (ì£¼ë§ í¬í•¨!)<br>
                        â€¢ ì‹¤ì œ ê±°ë˜ ê°€ê²© ë°˜ì˜<br>
                        â€¢ ë¬´ë£Œ, ë¹ ë¥¸ ì‘ë‹µ<br><br>
                        
                        âš ï¸ <strong>ì£¼ì˜ì‚¬í•­</strong><br>
                        â€¢ USDT í˜ê¹… ì´ìŠˆ ì‹œ ë¶€ì •í™•<br>
                        â€¢ ì—…ë¹„íŠ¸ ê¹€í”„ê°€ í™˜ìœ¨ì— ë°˜ì˜ë¨
                    </div>

                    <div class="recommended">
                        ğŸ’¡ ì‹¤ì œ ì€í–‰ í™˜ìœ¨ê³¼ Â±0.5~1% ì°¨ì´ ì˜ˆìƒ
                    </div>
                </div>
            `;
        } catch (error) {
            resultsDiv.innerHTML = `
                <div class="card">
                    <div class="status error">ì‹¤íŒ¨: ${error.message}</div>
                </div>
            `;
        }
    }

    // í˜ì´ì§€ ë¡œë“œ ì‹œ ìë™ í…ŒìŠ¤íŠ¸
    testAllSources();
</script>


</body>
</html>